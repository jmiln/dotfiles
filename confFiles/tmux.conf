### General {{{
    # Use UTF-8 encoding
    set -gq utf8
    set-window-option -gq utf8 on
    # Set scrollback history to 10000 (10k)
    set -g history-limit 10000
    # Visual notification of activity in other windows
    setw -g monitor-activity on
    # No automatic renaming of windows (from commands on execution)
    set-window-option -g automatic-rename off
### }}}

### Key Bindings {{{
    # Key combination prefix is <C-a>, not <C-b>
    set -g prefix C-a
    unbind-key C-b
    # Use send-prefix to pass C-a through to application
    bind C-a send-prefix

    # Reload ~/.tmux.conf using PREFIX r
    bind r source-file ~/.tmux.conf \; display "Reloaded!"

    # Reduce the command delay time to something a bit shorter
    set -sg escape-time 0
    # Extend the repeat interval for repeatable commands (e.g., resize-pane)
    set -sg repeat-time 1000

    # Enable vi-mode
    setw -g mode-keys vi
    set -g status-keys vi

    # Copy mode to escape key
    unbind [
    bind-key Escape copy-mode                                       # enter copy mode, default is [
    bind-key -T copy-mode-vi Escape send-keys -X cancel             # exit copy-mode, or hit q
    bind-key p paste-buffer                                         # paste
    bind-key -T copy-mode-vi v   send-keys -X begin-selection       # begin visual mode
    bind-key -T copy-mode-vi V   send-keys -X select-line           # visual line
    bind-key -T copy-mode-vi y   send-keys -X copy-selection        # yank/ copy
    bind-key -T copy-mode-vi C-v send-keys -X rectangle-toggle      # viual block toggle

    # If xsel is installed, this will send text to the clipboard
    bind-key < command-prompt -p "send to tmux:" "run-shell 'tmux set-buffer -- \"$(xsel -o -b)\"'"
    bind-key > command-prompt -p "send to xsel:" "run-shell 'tmux show-buffer | xsel -i -b'"
    bind-key / command-prompt "delete-buffer"

    # splitting and cycling
    unbind %
    bind \ split-window -h -c "#{pane_current_path}" # horizontal split
    unbind '"'
    bind _ split-window -v -c "#{pane_current_path}" # vertical split
    bind C-j previous-window
    bind C-k next-window

    # Swapping windows/ panes
    bind-key W choose-tree -w "swap-window -t '%%'"

    #tab
    bind-key -n C-pagedown next
    bind-key -n C-pageup prev
    bind-key -n C-right next
    bind-key -n C-left prev
    bind-key C-a last-window

    #Vi pane navigation
    bind h select-pane -L
    bind j select-pane -D
    bind k select-pane -U
    bind l select-pane -R

    bind ] resize-pane -R 10
    bind [ resize-pane -L 10
    bind - resize-pane -D 10
    bind + resize-pane -U 10

    # Disable mouse control
    set -gq mouse-utf8 off
    setw -g mouse off
### }}}

### Appereance {{{
    # Set the terminal color to 256color
    set -g default-terminal "screen-256color"
    set-option terminal-overrides "*88col*:colors=88,*256col*:colors=256,xterm*:XT"
    set -g terminal-overrides 'xterm*:smcup@:rmcup@'

    # Let pane/window numbers be 1-indexed
    set-option -g base-index 1
    set-option -g pane-base-index 1

    # Automatically renumber window numbers on closing a pane (tmux >= 1.7)
    set -g renumber-windows on

    # Set window notifications
    setw -g monitor-activity on
    set -g visual-activity off

    # Allow the arrow key to be used immediately after changing windows
    set-option -g repeat-time 0

    # Display tmux messages for 1 sec
    set -g display-time 1000

    ## Status Bar {{
        # For special character sequences such as #S, refer to manual
        # #T      = standard window title
        # #h      = short hostname
        # #S      = session name
        # #I      = tmux window index
        # #W      = tmux window name

        # Turn the status bar on
        set-option -g status on

        # Set UTF-8 for the status bar
        set -gq status-utf8 on

        # Update status every 5 seconds
        set-option -g status-interval 5

        # Center window list for clarity
        set -g status-justify centre

        # Configure contents in current window status
        setw -g window-status-current-format "<#I:#W#F>"
        # setw -g window-status-current-format "<#I:#W>"

        # Configure elements to show on left side of the status bar
        set-option -g status-left-length 40
        set-option -g status-left '#[fg=white]>> #[fg=green,bold] #{prefix_highlight} #T#[default]'

        # Configure elements to show in the center of the status bar
        set-option -g set-titles on
        set -g set-titles-string   '#W#F  #T'

        # window title colors; non active
        set-window-option -g window-status-fg cyan
        set-window-option -g window-status-bg default
        set-window-option -g window-status-attr dim

        # window title colors; active
        set-window-option -g window-status-current-fg white #font
        set-window-option -g window-status-current-bg red   #border
        set-window-option -g window-status-current-attr bright


        # Configure elements to show on right side of the status bar
        # localdate=$(date +"%Y-%m-%d")
        # localtime=$(date +"%H:%M")
        set-option -g status-right '#[fg=green,bold]>> #[fg=green] #(TZ="/usr/share/zoneinfo/US/Pacific" date +"%a %D %l:%M%p")'
        # set-option -g status-right '#[fg=green,bold]>> #[fg=green]%a %D %l:%M%p #[fg=red,bold] #(acpi | cut -d ',' -f 2)#[default]'
        # set -g status-right '#(TZ="US/Pacific" %a %D %l:%M%p)'
    ##}}

    ## Color {{
        # Set pane colors for the active pane
        set-option -g pane-border-fg green
        set-option -g pane-active-border-fg white

        # Set message text colors
        set-option -g message-fg yellow
        set-option -g message-bg black
        set-option -g message-attr dim

        # Set colors for the status bar
        set-option -g status-fg white
        set-option -g status-bg black
        set-option -g status-attr dim

        # Set window list colors
        set-window-option -g window-status-fg colour244
        set-window-option -g window-status-bg default
        set-window-option -g window-status-attr dim

        # window title colors; non active
        set-window-option -g window-status-fg cyan
        set-window-option -g window-status-bg default
        set-window-option -g window-status-attr dim

        # window title colors; active
        set-window-option -g window-status-current-fg white
        set-window-option -g window-status-current-bg red
        set-window-option -g window-status-current-attr bright
    ## }}
### }}}


### Plugins {{

# Install TPM with git clone https://github.com/tmux-plugins/tpm ~/.tmux/plugins/tpm

# List of plugins
set -g @plugin 'tmux-plugins/tpm'
set -g @plugin 'tmux-plugins/tmux-sensible'
set -g @plugin 'tmux-plugins/tmux-copycat'
set -g @plugin 'tmux-plugins/tmux-sidebar'
set -g @plugin 'Morantron/tmux-fingers'

set -g @plugin 'tmux-plugins/tmux-prefix-highlight'
    set -g @prefix_highlight_fg 'black' # default is 'colour231'
    set -g @prefix_highlight_bg 'green'  # default is 'colour04'
    set -g @sidebar-tree-command 'tree -C'


# Initialize TMUX plugin manager (keep this line at the very bottom of tmux.conf)
run -b '~/.tmux/plugins/tpm/tpm'
